# 智能分配功能测试说明

## 功能描述
当导入数据时，只有在产品图号和产品名称都与之前导入的数据完全一致时，系统才会自动分配上次的责任人。如果产品图号或产品名称有任何一个不一样，系统会将任务设为"待分配"状态，并用红色字体显示，提醒用户需要手动分配。

## 智能分配规则
1. **自动分配条件**：产品图号 + 产品名称完全匹配
2. **待分配条件**：产品图号或产品名称有任何一个不匹配
3. **特殊情况**：如果没有产品图号，只有产品名称完全匹配且置信度很高（>0.8）才自动分配

## 视觉提示
- **待分配任务**：
  - 师傅名称显示为红色粗体
  - 任务条使用红色边框和浅红色背景
  - 任务条内文字显示为红色
  - 在下拉选择中"待分配"选项为红色粗体

## 测试步骤

### 第一步：首次导入
1. 打开应用：http://localhost:8000
2. 点击"导入任务"按钮
3. 选择生成的测试文件：`智能分配测试_2025-07-13.xlsx`
4. 在字段映射步骤中，确保：
   - 产品名称 -> productName
   - 产品图号 -> productCode
   - 师傅 -> masterName（如果有此列）
5. 在预览步骤中，**手动为每个任务选择责任人**：
   - 液压缸总成 (HC-001) -> 选择一个师傅（如：潘敏）
   - 精密齿轮箱 (GB-002) -> 选择另一个师傅（如：黄尚斌）
   - 传动轴组件 (TA-003) -> 选择第三个师傅（如：钱伟）
   - 轴承座 (BS-004) -> 选择第四个师傅（如：蒋怀东）
   - 连接器组件 (CC-005) -> 选择第五个师傅（如：江峰）
6. 点击"确认导入"

### 第二步：测试精确匹配
1. 再次点击"导入任务"
2. 选择同一个测试文件：`智能分配测试_2025-07-13.xlsx`
3. 完成字段映射
4. 在预览步骤中，您应该看到：
   - 液压缸总成 (HC-001) 的所有任务都自动分配给了潘敏
   - 精密齿轮箱 (GB-002) 的所有任务都自动分配给了黄尚斌
   - 传动轴组件 (TA-003) 的所有任务都自动分配给了钱伟
   - 等等...

### 第三步：测试部分匹配（应该显示待分配）
创建一个新的测试文件，包含：
- 相同产品名称但不同图号的任务
- 相同图号但不同产品名称的任务
- 完全不同的产品

这些任务都应该显示为红色的"待分配"状态。

### 第四步：验证视觉提示
检查"待分配"任务是否：
- 师傅列显示红色文字
- 任务条有红色边框和浅红色背景
- 任务条内文字为红色
- 在编辑界面中"待分配"选项为红色粗体

## 智能分配优先级
1. **最高优先级**：产品图号 + 产品名称完全匹配
2. **特殊情况**：无产品图号时，产品名称完全匹配且置信度 > 0.8
3. **其他情况**：一律设为待分配

## 注意事项
- 系统会在导入时学习您的分配选择
- 每次手动分配都会提高该产品的分配置信度
- 只有完全匹配才会自动分配，确保分配的准确性
- 红色显示的"待分配"任务需要手动选择责任人

## 字体调整
- 师傅名称字体大小：根据名称长度自动调整，约为方框宽度的80%
- 产品名称字体大小：根据名称长度和任务条宽度自动调整，约为任务条宽度的80% 