# 数据同步使用说明

## 🔍 问题说明

### 为什么不同URL的数据不同步？

浏览器的**同源策略**导致不同URL的数据存储是完全隔离的：

```
http://localhost:3001/     ← 独立的数据存储空间
http://192.168.1.2:3002/   ← 另一个独立的数据存储空间
http://192.168.1.2:3000/   ← 又一个独立的数据存储空间
file:///E:/xxx/dist/       ← 文件协议的独立存储空间
```

每个URL都有自己的localStorage和数据库，**互不相通**！

## 💡 解决方案

### 方案1：使用数据同步工具（推荐）

1. **在有数据的URL上导出数据**：
   - 打开 `http://localhost:3001/`（有数据的地址）
   - 点击顶部的"数据同步"按钮
   - 在弹出的面板中点击"导出所有数据"
   - 系统会下载一个JSON文件到您的下载文件夹

2. **在没有数据的URL上导入数据**：
   - 打开 `http://192.168.1.2:3002/`（没有数据的地址）
   - 点击顶部的"数据同步"按钮
   - 在弹出的面板中点击"选择数据文件导入"
   - 选择刚才下载的JSON文件
   - 系统会自动导入数据并刷新页面

### 方案2：固定使用一个URL

**推荐使用开发服务器模式**：
```bash
npm run dev
```
然后固定访问：`http://localhost:3000/` 或服务器显示的地址

## 🛠️ 数据同步工具功能

### 当前存储状态显示
- **当前地址**：显示当前访问的URL
- **是否有数据**：显示当前地址是否有任务数据
- **任务数量**：显示当前存储的任务数量
- **SQLite数据**：显示数据库是否已初始化
- **存储大小**：显示当前数据占用的存储空间

### 导出数据
- 导出当前地址的所有数据（包括任务、设置、SQLite数据库）
- 生成JSON格式的备份文件
- 文件名格式：`生产看板数据_2025-07-16.json`

### 导入数据
- 从JSON文件导入数据
- 自动备份当前数据（防止意外丢失）
- 导入后自动刷新页面加载新数据

### 清除数据
- 清除当前地址的所有数据
- 用于重置或清理测试数据

## 📋 使用步骤

### 步骤1：确认数据位置
1. 打开有任务数据的URL（如 `http://localhost:3001/`）
2. 点击"数据同步"按钮
3. 查看"当前存储状态"，确认有数据

### 步骤2：导出数据
1. 在有数据的地址上点击"导出所有数据"
2. 等待文件下载完成
3. 记住下载文件的位置

### 步骤3：导入数据
1. 打开需要数据的URL（如 `http://192.168.1.2:3002/`）
2. 点击"数据同步"按钮
3. 点击"选择数据文件导入"
4. 选择刚才下载的JSON文件
5. 等待导入完成，页面会自动刷新

### 步骤4：验证数据
1. 刷新页面后，检查任务是否正常显示
2. 确认数据完整性

## ⚠️ 注意事项

### 数据安全
- 导入数据前会自动创建当前数据的备份
- 备份存储在浏览器的localStorage中
- 建议定期导出数据作为外部备份

### 浏览器兼容性
- 需要支持localStorage的现代浏览器
- 建议使用Chrome、Firefox、Edge等主流浏览器

### 文件格式
- 只支持导入系统生成的JSON格式文件
- 不要手动修改导出的JSON文件

## 🔧 高级功能

### 自动备份
系统会在以下情况自动创建备份：
- 导入数据前
- 数据迁移时
- 重要操作前

### 数据迁移
系统支持以下数据迁移：
- localStorage → SQLite
- 不同版本间的数据格式升级
- 便携包数据导入

### 存储监控
实时监控存储使用情况：
- 显示当前存储大小
- 提醒存储空间不足
- 建议清理或迁移策略

## 🆘 常见问题

### Q: 为什么导入后数据还是没有？
A: 请检查：
1. 是否选择了正确的JSON文件
2. 文件是否完整（没有被截断）
3. 浏览器是否支持localStorage
4. 是否有足够的存储空间

### Q: 数据导入失败怎么办？
A: 系统会自动恢复备份数据，或者：
1. 刷新页面重试
2. 检查文件格式是否正确
3. 尝试重新导出数据

### Q: 如何避免数据丢失？
A: 建议：
1. 定期导出数据备份
2. 使用固定的URL访问应用
3. 避免清除浏览器数据
4. 使用开发服务器模式而非文件协议

## 📞 技术支持

如果遇到问题，请检查：
1. 浏览器控制台是否有错误信息
2. 网络连接是否正常
3. 文件权限是否正确

---

**记住**：不同的URL = 不同的数据存储空间！使用数据同步工具可以轻松解决这个问题。
